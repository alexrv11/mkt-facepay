/* global document */
const handlers = require('./handlers');

const field = document.querySelector('.andes-form-control__field');
const label = document.querySelector('.andes-form-control__password-link');
const passwordValue = document.querySelector('.andes-form-control__password-value');
const container = document.querySelector('.andes-form-control');
const hasError = document.querySelector('.andes-form-control--error');
const message = document.querySelector('.andes-form-control__message-text');

function onClickShowPassword(e) {
  handlers.onClickShowPassword(passwordValue, e.target);
}

function onFocusPassword() {
  handlers.onFocus(container);
}

function onBlurPassword() {
  handlers.onBlur(container, field.value);
}

function onChangePassword() {
  handlers.onChange(passwordValue, field.value);
}

function onKeyUpTriggered() {
  if (hasError && message.style.display !== 'none') {
    message.style.display = 'none';
    container.classList.remove('andes-form-control--error');
  }
}

if (label) {
  label.addEventListener('click', onClickShowPassword);
}

if (field) {
  field.addEventListener('focus', onFocusPassword);
  field.addEventListener('blur', onBlurPassword);
  field.addEventListener('input', onChangePassword);
  field.addEventListener('keyup', onKeyUpTriggered);
}
